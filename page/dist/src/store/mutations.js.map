{"version":3,"sources":["../../../src/store/mutations.js"],"names":["isLoggedIn","token","localStorage","getItem","JSON","parse","userInfo","user","prevUrlName","urlName","msgCount","messageCount","state","loading","apiUrl","imgUrl","indexConf","isFooter","isSearch","isBack","isShare","title","pmdHeight","isMob","IsMobile","sUserAgent","navigator","userAgent","mobileAgents","ismob","i","length","indexOf","mutations","setItem","removeItem"],"mappings":"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","file":"mutations.js","sourcesContent":["import {\r\n  USER_SIGNIN,\r\n  USER_SIGNOUT,\r\n  USER_INFO,\r\n  MSG_COUNT,\r\n  PREV_URL_NAME,\r\n  CLEAR_PREV_URL_NAME\r\n} from './mutation-types.js'\r\n\r\n// 判断是否登录\r\nlet isLoggedIn = function () {\r\n  // TODO 此处可以写异步请求，到后台一直比较Token\r\n  let token = localStorage.getItem('token')\r\n  if (token) {\r\n    return JSON.parse(token)\r\n  } else {\r\n    return false\r\n  }\r\n}\r\n\r\nlet userInfo = function () {\r\n  // TODO 用户从Store获取\r\n  let user = localStorage.getItem('user')\r\n  if (user) {\r\n    return JSON.parse(user)\r\n  } else {\r\n    return false\r\n  }\r\n}\r\n\r\nlet prevUrlName = function () {\r\n  let urlName = localStorage.getItem('prev_url_name')\r\n  if (urlName) {\r\n    return urlName\r\n  } else {\r\n    return null\r\n  }\r\n}\r\n\r\n// 消息数量\r\nlet msgCount = function () {\r\n  let messageCount = localStorage.getItem('msgCount')\r\n  if (messageCount) {\r\n    return messageCount\r\n  } else {\r\n    return 0\r\n  }\r\n}\r\n\r\nconst state = {\r\n  token: isLoggedIn() || null,\r\n  user: userInfo() || {},\r\n  loading: false, // 是否显示loading\r\n  apiUrl: 'http://sa.taihuoniao.com', // 接口base url\r\n  imgUrl: 'http://sa.taihuoniao.com', // 图片base url\r\n  prevUrlName: prevUrlName(),\r\n  msgCount: msgCount(),\r\n  indexConf: {\r\n    isFooter: true, // 是否显示底部\r\n    isSearch: true, // 是否显示搜索\r\n    isBack: false, // 是否显示返回\r\n    isShare: false, // 是否显示分享\r\n    title: '' // 标题\r\n  },\r\n  pmdHeight: '0px', // 页面大图高度\r\n  isMob: false\r\n}\r\n\r\nlet IsMobile = function () {\r\n  let sUserAgent = navigator.userAgent\r\n  let mobileAgents = ['Android', 'iPhone', 'Symbian', 'WindowsPhone', 'iPod', 'BlackBerry', 'Windows CE']\r\n  let ismob = 0\r\n\r\n  for (let i = 0; i < mobileAgents.length; i++) {\r\n    if (sUserAgent.indexOf(mobileAgents[i]) > -1) {\r\n      ismob = 1\r\n      break\r\n    }\r\n  }\r\n\r\n  if (ismob) {\r\n    return true\r\n  } else {\r\n    return false\r\n  }\r\n}\r\n\r\nconst mutations = {\r\n  [USER_SIGNIN](state, token) {\r\n    localStorage.setItem('token', null)\r\n    localStorage.setItem('token', JSON.stringify(token))\r\n    state.token = token\r\n  },\r\n  [USER_SIGNOUT](state) {\r\n    localStorage.removeItem('token')\r\n    localStorage.removeItem('user')\r\n    localStorage.setItem('msgCount', 0)\r\n    state.token = false\r\n  },\r\n  [USER_INFO](state, user) {\r\n    localStorage.setItem('user', {})\r\n    localStorage.setItem('user', JSON.stringify(user))\r\n    state.user = user\r\n  },\r\n  [MSG_COUNT](state, msgCount) {\r\n    if (msgCount < 0) {\r\n      msgCount = 0\r\n    }\r\n    localStorage.setItem('msgCount', JSON.stringify(msgCount))\r\n    state.msgCount = msgCount\r\n  },\r\n  [PREV_URL_NAME](state, urlName) {\r\n    localStorage.setItem('prev_url_name', urlName)\r\n    state.prevUrlName = urlName\r\n  },\r\n  [CLEAR_PREV_URL_NAME](state) {\r\n    localStorage.removeItem('prev_url_name')\r\n    state.prevUrlName = null\r\n  },\r\n  INIT_PAGE(state) {\r\n    if (IsMobile()) {\r\n      state.isMob = true\r\n    } else {\r\n      state.isMob = false\r\n    }\r\n  }\r\n}\r\n\r\nexport default {\r\n  state,\r\n  mutations\r\n}\r\n"]}